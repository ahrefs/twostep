<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>TOTP (twostep.Twostep.TOTP)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">twostep</a> &#x00BB; <a href="../index.html">Twostep</a> &#x00BB; TOTP</nav><h1>Module <code>Twostep.TOTP</code></h1><p>Module for TOTP algorithm.</p></header><aside><p>This algorithm is useful on contexts of password managers, authenticator mobile applications or hardware vaults, that is, where the end-user has full control of OTP token generation.</p></aside><dl><dt class="spec value" id="val-secret"><a href="#val-secret" class="anchor"></a><code><span class="keyword">val</span> secret : <span>?&#8288;bytes:int</span> <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> string</code></dt><dd><p>Generates a valid Base-32 OTP secret (for both HOTP and TOTP algorithms, but don't mix them with the same secret, instead, generate a secret for every kind of usage). The optional <code>bytes</code> parameter represents the size of underlying binary/blob string of the encoded Base-32 secret. Such parameter must be at least <code>10</code> and <i>an integer divisible by 5</i>.</p></dd></dl><dl><dt class="spec value" id="val-code"><a href="#val-code" class="anchor"></a><code><span class="keyword">val</span> code : <span>?&#8288;window:int</span> <span>&#45;&gt;</span> <span>?&#8288;drift:int</span> <span>&#45;&gt;</span> <span>?&#8288;digits:int</span> <span>&#45;&gt;</span> <span>?&#8288;hash:string</span> <span>&#45;&gt;</span> <span>secret:string</span> <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> string</code></dt><dd><p>Generates an OTP token given valid Base-32 <code>secret</code>. The interval to expire the token is configured by the <code>window</code> optional parameter (defaults to <code>30</code> seconds). A clock <code>drift</code> of either positive or negative integers can be used when the server attempts to verify on past or future too. The <code>drift</code> parameter defaults to <code>0</code>, non-zero values are used mostly for custom verification, but it's not recommended that use. Instead, rely on <code>TOTP.verify</code> operation, which attempts to verify with clock drifts <code>-1</code>, <code>0</code> and <code>1</code> (30 seconds on past, now and 30 seconds on future, assuming that <code>window</code> is <code>30</code> seconds). Remaining optional parameters <code>digits</code> and <code>hash</code> are used to configure the token size (defaults to <code>6</code> characters) and HMAC hash (defaults to <code>&quot;SHA-1&quot;</code>, <code>&quot;SHA-256&quot;</code> and <code>&quot;SHA-512&quot;</code> are available too), respectively.</p></dd></dl><dl><dt class="spec value" id="val-verify"><a href="#val-verify" class="anchor"></a><code><span class="keyword">val</span> verify : <span>?&#8288;window:int</span> <span>&#45;&gt;</span> <span>?&#8288;digits:int</span> <span>&#45;&gt;</span> <span>?&#8288;hash:string</span> <span>&#45;&gt;</span> <span>secret:string</span> <span>&#45;&gt;</span> <span>code:string</span> <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> bool</code></dt><dd><p>Operation to verify TOTP codes. Optional parameters are <code>window</code> (how much seconds to expire the TOTP code/token, defaults to <code>30</code> seconds), <code>digits</code> (number of code/token characters, defaults to <code>6</code>) and <code>hash</code> (hash algorithm for internal HMAC, defaults to <code>&quot;SHA-1&quot;</code>, other options are <code>&quot;SHA-256&quot;</code> and <code>&quot;SHA-512&quot;</code>). The required <code>secret</code> parameter must be a valid Base-32 string, under the same format of <code>TOTP.secret()</code> operation. Returns a boolean flag for authentication/proof (<code>true</code> for valid token, <code>false</code> for invalid one).</p></dd></dl></div></body></html>